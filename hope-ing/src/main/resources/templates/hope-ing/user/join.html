<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.tymeleaf.org">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="/css/bootstrap/bootstrap.css" type="text/css">
<link rel="stylesheet" href="/css/join.css">
<title>Hope-ing</title>
</head>
<body>
<div class="wrap">
	<form method="post" id="joinForm">
		<div class="user_id" style="text-align: center;">
			<div class="user_id_input_box">
				<input class="user_id_input" name="user_id" placeholder="아이디" required>
				<div class="error-message" style="color: red;"></div>
			</div>
		</div>
		<br>
		<div class="user_pw" style="text-align: center;">
			<div class="user_pw_input_box">
				<input class="user_pw_input" name="user_pw" placeholder="비밀번호">
			</div>
		</div>
		<br>
		<div class="user_name" style="text-align: center;">
			<div class="user_name_input_box">
				<input class="user_name_input" name="user_name" placeholder="이름">
			</div>
		</div>
		<br>
		<div class="user_nickname" style="text-align: center;">
			<div class="user_nickname_input_box">
				<input class="user_nickname_input" name="user_nickname" placeholder="닉네임">
			</div>
		</div>
		<br>
		<div class="user_email" style="text-align: center;">
			<div class="user_email_input_box">
				<input class="user_email_input" type="email" name="user_email" placeholder="이메일">
			</div>
		</div>
		<br>
		<div class="user_phone_num" style="text-align: center;">
			<div class="user_phone_num_input_box">
				<input class="user_phone_num_input" name="user_phone_num" placeholder="전화번호">
			</div>
		</div>
		<br>
		<div class="signUp_button" style="text-align: center;">
			<button id="signUp_button" type="submit" class="btn btn-lg" style="background-color: #9edfbf;">가입하기</button>
		</div>
	</form>
</div>
<script th:src="@{/js/jquery-3.6.4.js}"></script>
<script>
	$(document).ready(function() {
		// 회원가입 폼 제출 시 AJAX 요청
		$('#joinForm').submit(function(e) {
			e.preventDefault();
			var form = $(this);
			var url = form.attr('action');
			var method = form.attr('method');
			var formData = form.serialize();
			var errorMessage = $('.error-message');  // 에러 메시지 요소
			
			$.ajax({
				url: url,
				method: method,
				data: formData,
				success: function(response) {
					location.href = '/hope-ing/user/login';  // 로그인 페이지로 이동
				},
				error: function(xhr) {
					if (xhr.status === 409) {
						$('.user_id_input').addClass('invalid');  // 아이디 입력란에 invalid 클래스 추가
						errorMessage.text('*사용 중인 아이디입니다.');  // 에러 메시지 출력
					}
				}
			});
		});
	});
</script>
</body>
</html>